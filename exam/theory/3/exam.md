# Графы. Списки смежности. BFS и DFS

## Графы

### Определение

Точки, соединенные ребрами (либо стрелками)

### Формально

1. Граф -- G(V, E). V -- вершины, E -- ребра (неупорядоченные пары вершин {x,y}, обозначаемые, тем не менее, (x, y))
2. Орграф (ориентированный граф) -- G(V, E). V - вершины, E - ребра (упорядоченные пары вершин (x,y))

### Определения 2

1. Обозначим n = |V| и m = |E|
2. Подграф графа G(V, E) -- граф G(V', E'), такой, что V' < V, E' < E (для {x, y} из E' и x,y из V')
3. Вершины смежны, если соединены ребром
4. Вершина x инцидентная ребру e = {y, z}, если x = y или x = z

### Представление в памяти

#### Матрица смежности

1. Матрица размера n^2
2. Можно узнать, есть ли ребро между x, y за O(1)
3. Перебор всех смежных с x вершин занимает O(n)
4. Размер O(n^2) всегда!

#### Списки смежности

1. Можно узнать, есть ли ребро между x и y за O(n)
2. Перебор смежных вершин с x занимает O(k), k -- число смежных вершин с x
3. Размер O(n+m)

## BFS

[bfs neerc itmo](https://neerc.ifmo.ru/wiki/index.php?title=%D0%9E%D0%B1%D1%85%D0%BE%D0%B4_%D0%B2_%D1%88%D0%B8%D1%80%D0%B8%D0%BD%D1%83)

Один из простейших алгоритмов обхода графа

### Описание алгоритма

Пусть задан невзвешенный ориентированный граф G(V, E), в котором выделена исходная вершина s. Требуется найти длина
кратчайшего пуи (если таковой имеется), от заданной вершины до другой. Частным случаем указанного графа является
невзвешенный неориентированный граф.

Для алгоритма требуется очередь и множество посещенных вершин marked, которое изначально содержит одну вершину s. На
каждом шаге алгоритм берет из начала очереди вершину v и добавляет все непосещенные смежные с v вершины в marked и в
конец очереди. Если очередь пуста, то алгоритм завершает свою работу.

Можно и без очереди, изначально создать distance, дистанция до всех вершин и задать это условной бесконечностью.
Если дистанция == бесконечности, то мы там не были.

Но надежнее с visited/was.

### Анализ времени работы

Оценим время работы для входного графа G= (V, E), где множество ребер E представлено списком смежности. В очередь
добавляются только непосещенные вершины, поэтому каждая вершина посещается не более 1 раза. Операции внесения в очередь
и удаления из нее требуют O(1) времени, так что общее время работы с очередью составляет O(|V|) операций. Для каждой
вершины v рассматривается не более deg(v) ребер, инцидентный ей. Так как сумма степеней вершин = 2|E|, то время,
используемое на работу с ребрами составляет O(|E|). Поэтому общее время работы алгоритма поиска в ширину -- O(|V| + |E|)

### Доказательство корректности

TODO

### Применения

- поиск кратчайшего пути в невзвешенном графе
- поиск компонент связности за O(n+m)

## DFS

[dfs neerc itmo](https://neerc.ifmo.ru/wiki/index.php?title=%D0%9E%D0%B1%D1%85%D0%BE%D0%B4_%D0%B2_%D0%B3%D0%BB%D1%83%D0%B1%D0%B8%D0%BD%D1%83,_%D1%86%D0%B2%D0%B5%D1%82%D0%B0_%D0%B2%D0%B5%D1%80%D1%88%D0%B8%D0%BD)

[dfs и его применения, расширенная версия для будущих алгоритмов](http://e-maxx.ru/algo/dfs)

### Описание алгоритма

#### Общая идея

Для каждой не пройденной вершины необходимо найти все не пройденные смежные вершины и повторить поиск для них

#### Пошагово

1. Выбираем любую вершину из еще не пройденных, обозначим ее u
2. Запускаем процедуру dfs(u)
    - Помечаем вершину u, как пройденную
    - для каждой не пройденной смежной с u вершиной (назовем ее v) запускаем dfs(v)
3. Повторяем шаги 1, 2, пока все вершины не окажутся пройденными.

### Время работы

Процедура dfs вызывается от каждой вершины не более одного раза, а внутри процедуры рассматриваются такие ребра e, что
их начало = u. Всего таких ребер для всех вершин в графе O(|E|), следовательно, время работы алгоритма O(|V| + |E|)

### Применения

- проверка связности
- поиск цикла и компонент сильной связанности
- топологическая сортировка



